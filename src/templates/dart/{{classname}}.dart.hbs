// ignore_for_file: lines_longer_than_80_chars
// ignore_for_file: one_member_abstracts

// AUTO-GENERATED FILE. DO NOT MODIFY
// This class was automatically generated.

abstract interface class I{{classname}}Tracker {
  void trackEvent(String event, Map<String, dynamic> parameters);
}

abstract interface class I{{classname}}GlobalParamsProvider {
  {{classname}}GlobalParams getGlobalParams();
}

abstract interface class I{{classname}}PlatformParamsProvider {
  {{classname}}PlatformParams getPlatformParams();
}

{{#each globalParameters.parameters}}
{{>enum parameter=this}}
{{/each}}
{{#unless (isEmpty globalParameters.parameters)}}
{{#each globalParameters.parameters}}
/// {{@index}}. {{name}} {{#if (isConst type)}}[const] {{/if}}- {{#escape newLine=" "}}{{../description}}{{/escape}}
{{/each}}
{{/unless}}
class {{classname}}GlobalParams {
  final Map<String, dynamic> parameters;

  {{#if (isEmpty globalParameters.parameters)}}
  {{classname}}GlobalParams() : parameters = const {};
  {{else}}
  {{classname}}GlobalParams({
    {{#each globalParameters.parameters}}
    {{#unless (isConst this.type)}}
    {{#unless (isDefined this.defaultValue)}}required {{/unless}}{{typeFormat this}}{{#eq this.defaultValue null}}?{{/eq}} {{camelcase this.name}}{{#if (isDefined this.defaultValue)}} = {{>defaultValueFormat parameter=this}}{{/if}},
    {{/unless}}
    {{/each}}
  }) : parameters = {
          {{#each globalParameters.parameters}}
          '{{this.name}}': {{camelcase this.name}},
          {{/each}}
        };
  {{/if}}
}

{{#if platformParameters}}
{{#each platformParameters.parameters}}
{{>enum parameter=this}}
{{/each}}
{{#unless (isEmpty platformParameters.parameters)}}
{{#each platformParameters.parameters}}
/// {{@index}}. {{name}} {{#if (isConst type)}}[const] {{/if}}- {{#escape newLine=" "}}{{../description}}{{/escape}}
{{/each}}
{{/unless}}
{{/if}}
class {{classname}}PlatformParams {
  final Map<String, dynamic> parameters;

  {{#if (isEmpty platformParameters.parameters)}}
  {{classname}}PlatformParams() : parameters = const {};
  {{else}}
  {{classname}}PlatformParams({
    {{#each platformParameters.parameters}}
    {{#unless (isConst this.type)}}
    {{#unless (isDefined this.defaultValue)}}required {{/unless}}{{typeFormat this}}{{#eq this.defaultValue null}}?{{/eq}} {{camelcase this.name}}{{#if (isDefined this.defaultValue)}} = {{>defaultValueFormat parameter=this}}{{/if}},
    {{/unless}}
    {{/each}}
  }) : parameters = {
          {{#each platformParameters.parameters}}
          '{{this.name}}': {{camelcase this.name}},
          {{/each}}
        };
  {{/if}}
}

class {{classname}} {
  final I{{classname}}Tracker eventTracker;
  final I{{classname}}GlobalParamsProvider globalParamsProvider;
  final I{{classname}}PlatformParamsProvider platformParamsProvider;

  {{classname}}({
    required this.eventTracker,
    required this.globalParamsProvider,
    required this.platformParamsProvider,
  });

  void trackEvent(String event, Map<String, dynamic> parameters) =>
      eventTracker.trackEvent(
        event,
        {
          ...parameters,
          ...globalParamsProvider.getGlobalParams().parameters,
          ...platformParamsProvider.getPlatformParams().parameters,
        },
      );

  {{#unless @root.disableSendingMeta}}
  Map<String, dynamic> makeMeta(
    {{#if @root.sendMetaEvent}}
    int eventVersion,
    {{/if}}
    {{#if @root.sendMetaInterfaces}}
    Map<String, dynamic> interfaces,
    {{/if}}
  ) =>
      {
        {{#if @root.sendMetaEvent}}
        'event': <String, dynamic> { 'version': eventVersion },
        {{/if}}
        {{#if @root.sendMetaInterfaces}}
        'interfaces': interfaces,
        {{/if}}
      };
  {{/unless}}
  {{#each eventNamespaces}}
  {{#each allVersions}}

  {{#each (splitByNewLine description)}}
  ///  {{this}}
  {{/each}}
  {{#if comment}}
  ///
  {{/if}}
  {{#each (splitByNewLine comment)}}
  ///  {{this}}
  {{/each}}
  {{#if (filterFalsy parameters 'type.Const')}}
  ///
  {{/if}}
  {{#filterFalsy parameters 'type.Const'}}
  {{#each this}}
  ///  {{sum @index 1}}. {{name}} - {{#escape newLine=" "}}{{../description}}{{/escape}}
  {{/each}}
  {{/filterFalsy}}
  {{#unless (isEmpty this.parameters)}}
  void {{camelcase this.name}}{{#gt this.version 1}}V{{this.version}}{{/gt}}({
    {{#unless (isEmpty additionalNamespaces)}}
    required {{pascalcase this.name}}Namespaces{{#gt this.version 1}}V{{this.version}}{{/gt}} namespace,
    {{/unless}}
    {{#filterUndefined this.parameters 'type.Const'}}
    {{#each this}}
    {{#unless (isDefined this.defaultValue)}}required {{/unless~}}
    {{typeFormat this}}{{#if (or (isRef defaultValue) (eq defaultValue null))}}?{{/if}} {{camelcase name~}}
    {{#if (and (isDefined defaultValue) (not (isRef defaultValue)))}} = {{>defaultValueFormat parameter=this}}{{/if}},
    {{/each}}
    {{/filterUndefined}}
  }) {
  {{else}}
  {{#if (isEmpty additionalNamespaces)}}
  void {{camelcase this.name}}{{#gt this.version 1}}V{{this.version}}{{/gt}}() {
  {{else}}
  void {{camelcase this.name}}{{#gt this.version 1}}V{{this.version}}{{/gt}}({
    {{#unless (isEmpty additionalNamespaces)}}
    required {{pascalcase this.name}}Namespaces{{#gt this.version 1}}V{{this.version}}{{/gt}} namespace,
    {{/unless}}
    {{#filterUndefined this.parameters 'type.Const'}}
    {{#each this}}
    {{#unless (isDefined this.defaultValue)}}required {{/unless~}}
    {{typeFormat this}}{{#if (or (isRef defaultValue) (eq defaultValue null))}}?{{/if}} {{camelcase name~}}
    {{#if (and (isDefined defaultValue) (not (isRef defaultValue)))}} = {{>defaultValueFormat parameter=this}}{{/if}},
    {{/each}}
    {{/filterUndefined}}
  }) {
  {{/if}}
  {{/unless}}
    {{#filterDefined this.parameters 'defaultValue'}}
    {{#each this}}
    {{#if (isRef this.defaultValue)}}
    final _{{camelcase this.name}} = {{camelcase this.name}} ?? {{camelcase (extractRef this.defaultValue)}}.value;
    {{/if}}
    {{/each}}
    {{/filterDefined}}
    {{#if (isEmpty this.parameters)}}
    final parameters = <String, dynamic>{};
    {{else}}
    final parameters = <String, dynamic>{
      {{#each this.parameters}}
      '{{this.name}}': {{#if (isRef this.defaultValue)}}_{{/if}}{{>variableValueFormat parameter=this}},
      {{/each}}
    };
    {{/if}}

    {{#unless @root.disableSendingMeta}}
    {{#if @root.sendMetaInterfaces}}
    {{#if (isEmpty this.interfaces)}}
    final interfacesDict = <String, dynamic>{};
    {{else}}
    final interfacesDict = <String, dynamic>{
      {{#each this.interfaces}}
      '{{@key}}': <String, dynamic>{ 'version': {{this}} },
      {{/each}}
    };
    {{/if}}

    {{/if}}
    parameters['_meta'] = makeMeta(
      {{~#if @root.sendMetaEvent~}}
      {{this.version}}
      {{~#if @root.sendMetaInterfaces}}, {{/if~}}
      {{~/if~}}
      {{~#if @root.sendMetaInterfaces~}}
      interfacesDict
      {{~/if~}}
    );
    {{/unless}}
    trackEvent({{#unless (isEmpty additionalNamespaces)}}namespace.toString() + '.' + {{/unless}}'{{this.event}}', parameters);
  }
  {{/each}}
  {{/each}}
}
{{#filterTruthy this.namedEnums "type.Enum.name"}}
{{#each this}}

{{>enum parameter=this}}
{{/each}}

{{/filterTruthy}}
{{#each globalTypes}}
{{#if (isEnum type)}}

{{>enum parameter=this}}
{{else}}

typedef {{pascalcase name}} = {{typeFormat this}};
{{/if}}
{{/each}}
{{#each eventNamespaces}}
{{#each allVersions}}
{{#filterFalsy this.parameters "type.Enum.name"}}
{{#each this}}
{{>enum parameter=this}}
{{/each}}
{{/filterFalsy}}
{{#unless (isEmpty additionalNamespaces)}}
enum {{pascalcase this.name}}Namespaces{{#unless @root.onlyLastVersion}}{{#gt this.version 1}}V{{this.version}}{{/gt}}{{/unless}} {
  {{#each additionalNamespaces}}
  {{camelcase this}}('{{this}}'){{#if @last}};{{else}},{{/if}}
  {{/each}}

  final String value;

  const {{pascalcase this.name}}Namespaces{{#unless @root.onlyLastVersion}}{{#gt this.version 1}}V{{this.version}}{{/gt}}{{/unless}}(this.value);
}
{{/unless}}
{{/each}}
{{/each}}
